model Election {
  id             Int       @id @default(autoincrement())
  name           String
  description    String    @default("")
  start          DateTime?
  end            DateTime?
  candidateStart DateTime?
  candidateEnd   DateTime?

  admins  User[]
  roles   Role[]
  voters  Voter[]
  ballots Ballot[]
}

model Voter {
  userID String  @id
  voted  Boolean @default(false)

  election   Election @relation(fields: [electionID], references: [id])
  electionID Int
  // Cannot link with Ballot/Vote due to traceability
}

model Ballot {
  id       Int      @id @default(autoincrement())
  election Election @relation(fields: [electionID], references: [id])

  electionID Int

  votes Vote[]
}

model Vote {
  ballot    Ballot    @relation(fields: [ballotID], references: [id])
  role      Role      @relation(fields: [roleID], references: [id])
  candidate Candidate @relation(references: [id], fields: [candidateID])
  position  Int

  roleID      Int
  ballotID    Int
  candidateID Int

  @@unique([ballotID, candidateID])
}

model Role {
  id       Int      @id @default(autoincrement())
  name     String
  election Election @relation(fields: [electionID], references: [id])

  electionID Int

  candidates Candidate[]
  votes      Vote[]
}

model Candidate {
  id          Int    @id @default(autoincrement())
  description String @default("")
  role        Role   @relation(fields: [roleID], references: [id])

  roleID Int

  users User[]
  votes Vote[]
}
